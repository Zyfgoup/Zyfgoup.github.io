<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="网络层 1.网络层提供的服务： 虚电路服务（面向连接）和数据报服务（无连接） 虚电路服务：类似通话网服务，通信期间长期占用此链接（链路必须负责可靠性传输） 数据报服务：通信期间不需要建立完整的长期链接（链路不负责可靠性传输，目的端和源端负责，比如差错性检验的循环冗余校验） 2.虚电路服务相关介绍： 1.网络上的报文一般都比较短，使用数据报服务的话即迅速又经济，使用虚电路的话又慢又贵（因为短报文需要">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络学习笔记(四)">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;12&#x2F;16&#x2F;%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="网络层 1.网络层提供的服务： 虚电路服务（面向连接）和数据报服务（无连接） 虚电路服务：类似通话网服务，通信期间长期占用此链接（链路必须负责可靠性传输） 数据报服务：通信期间不需要建立完整的长期链接（链路不负责可靠性传输，目的端和源端负责，比如差错性检验的循环冗余校验） 2.虚电路服务相关介绍： 1.网络上的报文一般都比较短，使用数据报服务的话即迅速又经济，使用虚电路的话又慢又贵（因为短报文需要">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212338147-2067929897.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212340053-1956048108.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212341904-219023030.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212344431-159424049.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212346097-11403096.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212348061-1394939781.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212349828-314079733.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212351351-119515397.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212352929-1080571287.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212354699-471763007.jpg">
<meta property="article:published_time" content="2019-12-16T13:02:18.000Z">
<meta property="article:modified_time" content="2019-12-16T13:19:29.375Z">
<meta property="article:author" content="Zyfgoup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;img2018.cnblogs.com&#x2F;blog&#x2F;1301290&#x2F;201812&#x2F;1301290-20181218212338147-2067929897.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/16/计算机网络学习笔记-四/"/>





  <title>计算机网络学习笔记(四) | Hexo</title>
  








<meta name="generator" content="Hexo 4.1.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%9B%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zyfgoup">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://s2.ax1x.com/2019/12/16/Q4NvnI.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">计算机网络学习笔记(四)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-16T21:02:18+08:00">
                2019-12-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index">
                    <span itemprop="name">计算机网络</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>  阅读数
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,843 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>网络层</strong></p>
<p><strong>1.网络层提供的服务：</strong></p>
<p>虚电路服务（面向连接）和数据报服务（无连接）</p>
<p><strong>虚电路服务</strong>：类似通话网服务，通信期间长期占用此链接（<strong>链路必须负责可靠性传输</strong>）</p>
<p><strong>数据报服务</strong>：通信期间不需要建立完整的长期链接（<strong>链路不负责可靠性传输，目的端和源端负责</strong>，比如差错性检验的循环冗余校验）</p>
<p><strong>2.虚电路服务相关介绍：</strong></p>
<p>1.网络上的报文一般都比较短，使用数据报服务的话即迅速又经济，使用虚电路的话又慢又贵（因为短报文需要多次连通虚电路，连通时间又不长）</p>
<p>2.使用数据报时，每个分组必须携带完整的地址信息，而虚电路只需要编号标志</p>
<p>3.虚电路服务时，虚电路负责差错控制和流量控制，而使用数据报时，主机承担端到端的差错控制和流量控制</p>
<p>4.<strong>虚电路时，某个结点发生故障，后续分组可以另选路由，而使用虚电路时，某个结点发生故障，则需要重新建立另一条虚电路</strong></p>
<p>虚电路服务代表：X25网</p>
<p>链路编号：虚电路号</p>
<p>X25规定经常通信的两端，该虚电路永久建立</p>
<p>特点：贵，兼容性不好</p>
<p><strong>3.数据报服务相关介绍：</strong></p>
<p><strong>数据报服务代表协议：IP协议族</strong></p>
<p>1.ARP地址解析协议（向下兼容）</p>
<p>2.RARP逆向地址解析协议（已废，向下兼容）</p>
<p>3.ICMP网际控制报文协议（<strong>向上提供服务</strong>）</p>
<p>4.IGMP网际组管理协议（<strong>向上提供服务</strong>）</p>
<p><strong>虚拟的互联网需要解决的问题：</strong></p>
<ol>
<li><p>不同的寻址方案</p>
</li>
<li><p>不同的最大分组长度</p>
</li>
<li><p>不同的网络接入机制（10M，100M，1G，带宽）</p>
</li>
<li><p>不同超时控制</p>
</li>
<li><p>不同的差错恢复方法</p>
</li>
<li><p>不同的状态报告方法（收到确认信号）</p>
</li>
<li><p>不同的路由选择技术（选择质量高的，还是速度快的，还是兼具的）</p>
</li>
<li><p>不同的用户接入控制（WIFI接入，拨号接入）</p>
</li>
<li><p>不同的服务（仍有部分虚电路服务在提供）</p>
</li>
</ol>
<p><strong>中间设备的分类：</strong></p>
<ol>
<li><p>物理层使用的中间设备：转发器</p>
</li>
<li><p>数据链路层使用的中间设备：网桥</p>
</li>
<li><p>网络层使用的中间设备：路由器</p>
</li>
<li><p>网络层以上使用的中间设备：网关（链接两个不兼容的系统，需要在高层进行协议的转换）</p>
</li>
</ol>
<p><a href="https://blog.csdn.net/u012243115/article/details/47008903" target="_blank" rel="noopener"><strong>转发器、集线器、网桥、交换机、路由器和网关简介</strong></a></p>
<p><strong>4.IP地址的相关介绍</strong></p>
<p><strong>IP地址大小：32位，局域网和广域网IP可以重叠</strong></p>
<p><strong>IP地址的编址方式：</strong></p>
<p><strong>第一种：分类IP地址：网络号+主机号</strong></p>
<p>A类：前8位为网络号（为A类的标志：开始第一位为：0）</p>
<p>B类：前16位为网络号（为B类的标志，前2位为：10）</p>
<p>C类：前24位为网络号为C类地址的标志，前3位为：110）</p>
<p>D类：D类地址的标志：前4位为：1110</p>
<p>E类：E类地址的标志：前5位为：11110（E类还没有用过）</p>
<p>ps：路由转发的时候先查找网络号，这样直接发到一个网络中，然后由网络中的路由器转发到对应的机器，这样路由的转发表会比较小</p>
<p><strong>分类IP地址的具体分析：</strong></p>
<p>A：（1/2）</p>
<p>网络号全0：表示我整个内网</p>
<p>网络号全1：广播网（回旋报文）</p>
<p>B，C类不具体分析</p>
<p>特殊的IP地址：</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212337447-531955807.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212338147-2067929897.jpg" alt="wps5420.tmp"></a></p>
<p><strong>IP地址的一些重要特点：</strong></p>
<ol>
<li><p>分等级的结构地址：好处有两点：1.IP管理机构只用管理网络号，主机号有该网络号单位自己分配，减轻了IP管理机构的压力，2。路由器只根据网络号来转发数据，不考虑主机号，这样就减轻了路由表的储存查找压力（先找到网络号对应的网络，然后又该网络号的单位查找对应的主机号然后发送）</p>
</li>
<li><p>路由至少又两个IP地址（因为路由就是来链接不同的以太网的，所以至少有两个网络号，网络号的单位又给它各自分配了一个主机号，所以路由器至少两个IP地址）</p>
</li>
<li><p>用转法器或者网桥链接起来的局域网具有相同的网络号，所以他们是同一个以太网</p>
</li>
</ol>
<p>MAC地址是在某个以太网内部来找主机的，而IP地址中的网络号是找网络的！！</p>
<p><strong>5.地址解析协议：</strong></p>
<p>每一个主机都又一个APR，里面又所在以太网上的各主机和路由器的IP地址到硬件地址的映射表<br>APR是解决同一个以太网上的主机或路由器的IP地址和硬件地址的映射问题</p>
<p>比如A发送数据给B，就要知道B的IP地址和MAC地址，先在A的以太网上查找有没有B对应的IP地址和MAC地址对应的映射，没有的话，路由器会做响应，从而在其他以太网内查</p>
<p>每个路由管一部分IP地址的主机，所以找的是以太网内特定的路由器</p>
<p><strong>6.IP数据报的格式：</strong></p>
<p><strong>首部和数据</strong></p>
<p>首部中保存一些固定部分</p>
<p>我们主要了解固定部分</p>
<p><strong>IP数据报首部分析：（20个字节，20*8位）</strong></p>
<ol>
<li><p>版本（4位）：IPV4，IPV6</p>
</li>
<li><p>首部长度（4位）：单位4字节，比如首部长度为3，表示首部有3*4个字节</p>
</li>
<li><p>服务类型（8位）：现在没有使用</p>
</li>
<li><p>总长度（16位）：头部加数据部分形成的数据报的总长度</p>
</li>
<li><p>标识（16位）：一个数据，分成好几个报文，然后一个报文继续分组（同一个报文在发送的时候被分成好几个分组，不然发送不了，太大了），同一个报文的不同分组标识的相同的，标识属于哪个报文（往上的，对应传输层）</p>
</li>
<li><p>标志（3位，只有后两位有用）：中间一位表示允不允许分MAC帧，最后一位标识我是不是最后一个MAC帧，标识该帧是不是结束帧</p>
</li>
<li><p>片偏移：一个报文要分成好几个MAC帧发送。该帧属于第几帧</p>
</li>
<li><p>生成时间：单位是跳，经过一个路由转发是一跳</p>
</li>
<li><p>协议：向上兼容传输层的协议，该数据报是来自于传输层那个协议的报文</p>
</li>
<li><p>首部检验和：校正首部的准确性（采用反码和的方式）</p>
</li>
<li><p>源地址：来自哪里</p>
</li>
<li><p>目的地址：去哪里</p>
</li>
</ol>
<p><strong>7.MAC帧部分及其介绍：</strong></p>
<p>一个IP报文分成好几个MAC帧</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212339386-179661278.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212340053-1956048108.jpg" alt="wps5421.tmp"></a></p>
<p>一个数据报组成：首部+数据</p>
<p>一个数据报分成好几个MAC帧</p>
<p><strong>MAC帧组成：首部+数据</strong></p>
<p>所以多个首部，注意理解</p>
<p><strong>ps：反码校验和算法：</strong></p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212341222-519490165.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212341904-219023030.jpg" alt="wps5422.tmp"></a></p>
<p><strong>8.路由和交换机的区别：</strong></p>
<ol>
<li><p>路由用来链接不同的以太网，而交换机只负责一个特定网络中的工作</p>
</li>
<li><p>路由用来转发分组，而交换机可链接主机（路由面向以太网，交换机面向主机）</p>
</li>
<li><p>路由使用同一的IP协议，而交换机使用所在以太网的特定协议</p>
</li>
</ol>
<p><strong>9.第二种IP地址的编址方式：划分子网</strong></p>
<p>原因：为了弥补分类地址的缺陷</p>
<p><strong>分类地址的缺陷：</strong></p>
<ol>
<li><p>IP地址空间的利用率有时很低（小型的独占一个网络，利用率低，学校网利用率高（pc机多）</p>
</li>
<li><p>给每个网络分配一个网络号使路由表性能变坏（虽然路由只储存网络号，不存储主机号，但是架不住网络号多啊）</p>
</li>
<li><p>两级IP地址不够灵活（待思考）</p>
</li>
</ol>
<p><strong>划分子网的操作：两级IP地址变成3级IP地址</strong></p>
<p>3级：网络号+子网号+主机号</p>
<p>2级：网络号+主机号</p>
<p>从2级主机号借用一段用做子网号</p>
<p>Ps：划分子网纯属一个网络内部的事情！！！</p>
<p>一个以太网内，把该以太网内部的主机分成一组一组，一组就是一个子网，所以划分子网是我这个以太网内部的事情</p>
<p><strong>划分子网后网络发送数据的具体流程：</strong></p>
<ol>
<li><p>根据IP数据报的目的网络号找到连接该网络的路由器</p>
</li>
<li><p>路由收到该IP数据报</p>
</li>
<li><p>路由先按照子网号找到对应的子网</p>
</li>
<li><p>路由再按照子网内的主机号找到对应主机</p>
</li>
</ol>
<p>特殊点：路由会按照子网号先找到对应的子网，找到对应子网之后再在子网内部按照主机号找到对应主机，没有子网号的时候，该网络的路由是直接甩锅，按照主机号找对应主机的工作是交给集线器和交换机的</p>
<p><strong>子网划分示意图</strong>：</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212343408-193396941.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212344431-159424049.jpg" alt="wps5433.tmp"></a></p>
<p>局域网是数据链路层概念</p>
<p>子网是网络层概念</p>
<p>子网由单位内部自己决定</p>
<p>子网掩码：帮助路由找出IP数据报中的子网号</p>
<p>先根据三级IP地址找到子网掩码，然后根据子网掩码找到目的子网，然后更加子网找到子网地址，最后找到的就是IP地址对应的主机</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212345434-2076645750.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212346097-11403096.jpg" alt="wps5434.tmp"></a></p>
<p>网络地址：划分成一个个子网的地址，通过三级IP地址和子网掩码做and操作得到</p>
<p>A类地址的子网掩码：255.0.0.0</p>
<p>B类地址的子网掩码：255.255.0.0</p>
<p>C类地址的子网掩码：255.255.255.0</p>
<p>因为划分了子网，所以路由记录的是网络号和子网号</p>
<p><strong>第三种IP地址的编址方式：无分类编址（CIDR）：构成超网</strong></p>
<p>IP编址问题改进的演变：</p>
<p>第一次：划分子网，子网号不同，IP不同</p>
<p>第二次：无分类编址（IP构成部分长度不固定，灵活）</p>
<p>第三次：CIDR：使用各种长度的网络前缀来代替分类地址中的网络号和子网号，不同以前的是网络号和子网号的长度不是固定的</p>
<p>采用CIDR的IP地址构成：网络前缀+主机号</p>
<p>CIDR将网络前缀相同的连续IP地址构成CIDR地址块，叫做一个超网</p>
<p>比如：128.12.32.0/20表示地址块共有2的12次方个地址（20表示网络前缀占前面的20位，IP地址总长规定是32位，所以32-20=12，所以该地址块有2的12次方个IP地址）</p>
<p><strong>路由聚合：</strong>一个CIDR地址块可以表示很多地址，这种地址的聚合通常称为路由聚合，它使得路由表一行可以表示很多个原来传统分类的地址路由</p>
<p>路由聚合页叫做构成超网</p>
<p>CIDR虽然不使用子网，但仍然使用掩码这个概念（前缀全1，主机号全0）</p>
<p>用转法器或网桥连接起来的若干个局域网仍为一个网络，因此这些局域网都具有相同的网络号</p>
<p><strong>最长网络前缀匹配：</strong>在路由表中匹配的时候，可能有多个匹配结果，虽然都能到达目的地，但是网络前缀越长，主机数量越少，查起来就越方便</p>
<p><strong>路由表的储存查找：</strong>使用二叉树，对路由表中的每一条ip地址转换为二进制表示，得到每一个ip地址的唯一前缀（路由表中的每一个唯一前缀都是不相同的）利用唯一前缀构造二叉树，查到二叉树的叶子结点就代表查找完成了（线索二叉树）</p>
<p><strong>网际控制协议ICMP：为了提高IP数据报交付成功的机会</strong></p>
<p>ICMP允许主机或者路由器报告差错情况，ICMP的报文作为IP层数据报的数据部分进行传输，ICMP属于IP协议族的一部分</p>
<p><strong>ICMP的具体构成：</strong></p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212347353-383994955.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212348061-1394939781.jpg" alt="wps5435.tmp"></a></p>
<p>1.类型：什么类型的ICMP报文</p>
<p>2.代码：某种错误或者异常对应的代码</p>
<p>3.校验和：校验</p>
<p>4.ICMP的数据部分</p>
<p>注意ICMP报文作为IP报文分组的一部分在网络中传输</p>
<p>ICMP报文的种类：ICMP差错报告报文和ICMP询问报文</p>
<p><strong>ICMP差错报文的5种：</strong></p>
<ol>
<li><p>终点不可达</p>
</li>
<li><p>源站抑制：源点不允许你向某终点发送数据</p>
</li>
<li><p>时间超过</p>
</li>
<li><p>参数问题：校验和不对</p>
</li>
<li><p>改变路由（重定向）：可 以走一条新的路径</p>
</li>
</ol>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212349227-238508530.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212349828-314079733.jpg" alt="wps5436.tmp"></a></p>
<p>出问题的数据报文中取出首部和随后的8个字节组成ICMP差错报文的首部和随后的8个字节，然后ICMP差错报文作为一个新的IP数据报的数据部分重新在网络中传输</p>
<p>一个是出错的报文，一个是报告为什么出错的报文</p>
<p><strong>不发送ICMP差错报文的四种情况：</strong></p>
<ol>
<li><p>对ICMP差错报告报文不再发送ICMP差错报告报文：ICMP差错报告报文就算出错了也不再发送该ICMP差错报告报文的ICMP差错报告报文</p>
</li>
<li><p>对第一个分片的数据报片的所有后续分片都不发送ICMP差错报告报文：多给码片只发送一个ICMP差错报告报文</p>
</li>
<li><p>对具有多播地址的数据报不发生ICMP差错报告报文</p>
</li>
<li><p>对具有特殊地址的IP报文不发送ICMP差错报告报文</p>
</li>
</ol>
<p><strong>路由的选择策略问题：</strong></p>
<p><strong>静态路由选择策略：即非自适应性的路由选择，其特定是简单和开销小，但不能及时感知网络状态的变化</strong></p>
<p><strong>动态路由选择策略：即自适应路由选择，其特定是能较好的适应网络状态的变化，但较为复杂，其开销也比较大</strong></p>
<p><strong>分层次的路由选择策略：划分自治域</strong></p>
<p>原因：因为英特网的规模非常大，如果不划分的话，每个路由器需要存储的路由表实在太多了，划分自治域，一个自治域其实就是一个小的互联网，很多个自治域就构成了我们整个的以太网</p>
<p>自治系统有权自主的选择本系统内选择何种路由选择协议</p>
<p>自治域有两种路由选择协议：</p>
<p><strong>1. 内部网关协议IGP：自治系统内部间的通信（RIP协议和OSPF协议）</strong></p>
<p><strong>2. 外部网关协议EGP：自治系统和自治系统间的通信（BGP协议）</strong></p>
<p>内部网关协议RIP协议：分布式的基于距离向量的路由选择协议</p>
<p>距离定义：路由跳数（直接连接距离为1）</p>
<p>一条路径最多有15个路由（限制了自治系统的大小）</p>
<p><strong>RIP协议的三要素：</strong></p>
<p><strong>1. 仅和相邻的路由器交换信息</strong></p>
<p><strong>2. 交换的信息是当前路由器知道的全部信息（即自己的整个路由表）</strong></p>
<p><strong>3. 按固定时间间隔交换路由信息</strong></p>
<p><strong>路由表构成：目的网络+掩码+下一条路由+距离向量</strong></p>
<p>RIP的距离向量算法：</p>
<p>y收到相邻路由器x的一个RIP报文</p>
<ol>
<li><p>先修改此RIP报文中的所有项目，下一跳都改成x，所有距离向量都加1</p>
</li>
<li><p>若RIP中的目的网络不在y自己的路由表中，则将此RIP中的该网络这一行都加入y的路由表中</p>
</li>
<li><p>若RIP中的目的网络在y的路由表中的话，如果下一跳给出的路由地址和y的该网络给出的下一跳路由地址是同样的话，则将收到的项目替换y中的项目，否则的话，如果x中该项目的距离小于y中该项目的距离，则进行距离向量的更新</p>
</li>
<li><p>如果3分钟还没有收到向量路由器的路由表，则将该路由器记为不可达（距离16）</p>
</li>
</ol>
<p>RIP协议的位置：使用运输层的UDP用户数据报进行传输，RIP位置是在应用层，但IP数据报的过程是在网络层完成的，具体看下图：</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212350842-1902261083.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212351351-119515397.jpg" alt="wps5437.tmp"></a></p>
<p>路由表的构成：路由标记+网络地址+掩码+下一跳路由器地址+距离</p>
<p>RIP报文=首部+路由部分</p>
<p>UDP用户数据报=UDP首部+RIP报文</p>
<p>IP报文=IP报文首部+UDP用户数据报</p>
<p>RIP路由选择协议的优点：</p>
<ol>
<li>实现简单，开销小</li>
</ol>
<p>RIP路由选择协议的缺点：</p>
<ol>
<li><p>有可能跳数少的路径拥堵，跳数多的路径虽然条数多，但是不拥挤带宽高，速度反而快</p>
</li>
<li><p>某个网络出现故障的话，需要很长的时间才能将信息传送到该自治系统的所有路由器（好消息传播得快，坏消息传播得慢！！！！）</p>
</li>
<li><p>网络规模扩大，传送的路由表信息的开销也加大（不能算是很大的缺点吧）</p>
</li>
</ol>
<p><strong>内部网关协议OSPF</strong></p>
<p>交换的不是整个路由表，而是相邻的链路的状态</p>
<p>链路状态就是说明本路由器和哪些路由器相邻，以及该链路的度量</p>
<p>只有当链路状态发生变化时，路由器才用洪泛法向所有路由器发送此消息</p>
<p>就是说链路状态变化时间，相邻路由器向所有路由器发送所有链路状态改变的消息</p>
<p>度量是根据自己的需求去确定的</p>
<p>由于各路由器之间频繁的交换链路状态信息，因此所有的路由器最终都能建立一共链路状态数据库</p>
<p>对自制系统继续进行划分，划分为区域，因为网络过大的话，链路状态数据库需要存储的信息太多了（存的是边），32位的区域标识符</p>
<p><strong>内部网关协议OSPF的特点：</strong></p>
<ol>
<li><p>OSPF不用封装城UDP数据报，而是直接用IP数据报传送，可见OSPF的位置在网络层</p>
</li>
<li><p>OSPF的数据报很短（只有在链路状态发生变化的时候发送自己的路由信息，洪泛法）</p>
</li>
<li><p>度量可以多样化，可以根据业务需求自己设置</p>
</li>
<li><p>OSPF路由器之间交换的分组有鉴别功能（每个链路的状态都有一个32位的序号，序号越大状态就越新）</p>
</li>
<li><p>每隔一段数据刷新一次数据库中的链路状态</p>
</li>
<li><p>当互联网规模大时OSPF协议比RIP距离向量协议号很多（因为一个路由器的链路状态只和相邻的路由器有关，而RIP记录了全自治系统路由器的链路信息，所以OSPF没有限制自治系统的大小）</p>
</li>
<li><p>没有坏消息传播得慢的问题</p>
</li>
</ol>
<p>内部网关协议OSPF的组成图：</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212352454-310779759.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212352929-1080571287.jpg" alt="wps5448.tmp"></a></p>
<p>版本：协议版本</p>
<p>类型：（5种类型，见下文）</p>
<p>分组长度：数据的长度（因为数据量小，所有不分片）</p>
<p>路由器标识符：记录链接在路由器我的哪个端口上</p>
<p>区域标识符：在自治系统的哪个区域</p>
<p>检验和：校验首部对错</p>
<p>鉴别类型：相当于加密操作，要鉴别的话有鉴别码（扩展知识）</p>
<p>鉴别：鉴别码</p>
<p>OSPF分组：OSPF分组首部+数据部分（之所以不叫报文叫分组是因为数据量小，一次可以全部发过去，不用分片）</p>
<p>OSPF分组封装在IP数据报的数据部分</p>
<p>IP数据报=IP数据报首部+IP数据报的数据部分</p>
<p>OSPF：可靠洪泛法</p>
<p>OSPF的5种分组类型：</p>
<ol>
<li><p>问候分组：确定我们之间的链路有没有问题</p>
</li>
<li><p>数据库描述分组：和我相邻的路由器的链路的一些状态（路由表）</p>
</li>
<li><p>链路状态请求分组：请求你的路由表</p>
</li>
<li><p>链路状态更新分组：链路状态请求的返回分组（用洪泛法对全网更新链路状态）</p>
</li>
<li><p>链路状态确认分组：成功接收与否的状态，可靠算法的保证</p>
</li>
</ol>
<p>OSPF使用的可靠洪泛法：我收到这条链路状态更新分组之后，给发送方发一个确认分组（保证可靠），然后向与我相连的路由器发送收到的链路更新分组</p>
<p>指定路由：管理该区域的路由，外面区域的信息传进来的时候，传给指定路由，由指定路由去完成接下来的工作</p>
<p>OSPF内部网关协议支持的三种网络连接：</p>
<ol>
<li><p>两个路由器之间的点对点连接</p>
</li>
<li><p>具有广播功能的局域网</p>
</li>
<li><p>无广播功能的广域网（一个自治系统是一个广域网）</p>
</li>
</ol>
<p>网络拓扑的表现形式：有向图形式，树形式</p>
<p>外部网关协议之BGP协议（BGP4版）</p>
<p>使用背景：因特网规模太大，在自治系统之间选择一条最佳的路径是不现实的，因为边界网关协议BGP只是力求寻找一条可以到达目的网络且比较好的路由，而不是要寻找一条最佳路由</p>
<p>一个自治系统内部有一个BGP发言人，辅助交自治系统和自治系统之间的路由信息</p>
<p>BGP交换路由信息的过程：先建立TCP连接，然后在此连接上交换BGP报文以建立BGP会话，利用BGP会话交换BGP发言人间的路由信息（因为TCP的可靠的）</p>
<p>一个BGP发言人只和自己相邻的BGP发言人交换路由信息</p>
<p>其实BGP外部网关协议类似RIP内部网关协议</p>
<p>主干网自治系统管理地区自治系统，地区自治系统管理本地自治系统（看图):</p>
<p><a href="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212354209-1831433535.jpg" target="_blank" rel="noopener"><img src="https://img2018.cnblogs.com/blog/1301290/201812/1301290-20181218212354699-471763007.jpg" alt="wps5449.tmp"></a></p>
<p>层次网络管理，主干网管理地区ISP，地区ISP管理本地ISP</p>
<p>（就是你到达你的目的地，可以经过X，X，X…..)</p>
<p>一个自治系统一般1个或者2个发言人</p>
<p>BGP协议要记录整个路径（不仅记录下一跳，还要记录下一跳的下一跳）</p>
<p>BGP协议的4种报文：</p>
<ol>
<li><p>打开报文：用来与相邻的另一发言人建立关系（类似OSPF的问候分组）</p>
</li>
<li><p>更新报文：更新交互链路信息报文</p>
</li>
<li><p>保活报文：证实和邻站的关系（断了吗）</p>
</li>
<li><p>通知报文：保活报文的回复，告诉你我之间的状态</p>
</li>
</ol>
<p>IP多播（目的地址有多个，不是多个单播）：明显减少网络资源的消耗</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%89/" rel="next" title="计算机网络学习笔记(三)">
                <i class="fa fa-chevron-left"></i> 计算机网络学习笔记(三)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94/" rel="prev" title="计算机网络学习笔记(五)">
                计算机网络学习笔记(五) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
						<a href="/">
              <img class="site-author-image" itemprop="image"
                src="https://s2.ax1x.com/2019/12/16/Q4NvnI.jpg"
                alt="Zyfgoup" />
								</a>
            
              <p class="site-author-name" itemprop="name">Zyfgoup</p>
              <p class="site-description motion-element" itemprop="description">满船清梦压星河</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Zyfgoup" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zyfgoup</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
